package io.github.zebalu.aoc2021;

import java.util.Comparator;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class Day25 {
    public static void main(String[] args) {
        firstPart();
        System.out.println("Merry Christmas!");
    }

    private static void firstPart() {
        SeaFloorMap map = SeaFloorMap.fromString(INPUT);
        int steps = 0;
        int moved = 0;
        do {
            moved = map.tick();
            ++steps;
        } while (moved != 0);
        System.out.println(steps);
    }

    private static class SeaFloorMap {
        private final Map<Coord, Character> cucumbers;
        private final int limitX;
        private final int limitY;

        private SeaFloorMap(Map<Coord, Character> cucumbers) {
            this.cucumbers = cucumbers;
            limitX = cucumbers.keySet().stream().mapToInt(Coord::x).max().orElseThrow() + 1;
            limitY = cucumbers.keySet().stream().mapToInt(Coord::y).max().orElseThrow() + 1;
        }

        int tick() {
            return move('>') + move('v');
        }

        private List<Coord> findMovables(char direction) {
            return cucumbers.keySet().stream()
            .filter(k -> cucumbers.get(k) == direction && !cucumbers.containsKey(k.next(limitX, limitY, direction)))
            .toList();
        }
        
        private int move(char direction) {
            var toMove = findMovables(direction);
            move(toMove, direction);
            return toMove.size();
        }
        
        private void move(List<Coord> toMove, char direction) {
            toMove.stream().forEach(c -> {
                    cucumbers.remove(c);
                    cucumbers.put(c.next(limitX, limitY, direction), direction);
            });
        }

        static SeaFloorMap fromString(String scan) {
            var lines = INPUT.lines().toList();
            var map = new HashMap<Coord, Character>();
            for (int y = 0; y < lines.size(); ++y) {
                String line = lines.get(y);
                for (int x = 0; x < line.length(); ++x) {
                    if (line.charAt(x) != '.') {
                        map.put(new Coord(x, y), line.charAt(x));
                    }
                }
            }
            return new SeaFloorMap(map);
        }
    }

    private static final record Coord(int x, int y) implements Comparable<Coord> {
        private static final Comparator<Coord> COORD_COMPARATOR = Comparator.comparingInt(Coord::x).thenComparingInt(Coord::y);
        Coord next(int maxX, int maxY, char direction) {
            if (direction == '>') {
                int nX = (x + 1 < maxX) ? x + 1 : 0;
                return new Coord(nX, y);
            } else if (direction == 'v') {
                int nY = (y + 1 < maxY) ? y + 1 : 0;
                return new Coord(x, nY);
            }
            throw new IllegalArgumentException("unknown direction: " + direction);
        }
        @Override
        public int compareTo(Coord o) {
            return COORD_COMPARATOR.compare(this, o);
        }
    }

    private static final String INPUT = """
            v.....>..v...vv>v>.v>v.....>v.v>.>..v>>>.>>..vvv>.vvvvvvvv..vv....>..>>vv..........>>...v>.>...v>vvvv>>..v>vv..v>.v..>>...>v>....>>>......v
            >>>>.v....v>.....>.v..>.v>v.v..>..>>>.v....v.v>.>>.v>..v>>v...v>..v..>.>v>>.>vv.>..v..vv.>v>v.>v..v.v>v>>vv..>..>.v.vv.>v.v..vvv..>...>>...
            .>>>...v.>.vv.>.vv.v>v>.v..v>>.>..v>.>....>>...>v.....v..v>..v>...v>v.>.v..>vvv..>v..vvvvvv......>>v.v.v.>..>.v...>v..vv.v.v>.v...>vv.>....
            >>>vv.v.>...v.....>>v..>>vv..vvv.v..>v>.>.>>..vv>..>.v>v.v.v>.v.vv>>v....>.>.v>>.>vvv.>>..vvvv>v.....>.v...>.>vv.v.>>.>...v.vv.>.vvv.v>>...
            .>>v.v>....>vv.>v>.v>...>>>.v>>.>vv.>>....vv....>v...>..>..>.v..>.>.>>vv>>..v>...v>>v.v>.v.vvv..>..v.>v.>>>>...v...vv>.>vv...>>.>..>>>vv>.v
            >....>>>>v>.>>v>.>>..v..v....v...>>v.vvv..>..>vvv.v.v.>....vv.v>v..v.vv.v..vv>..>>..>v.>.....v.>>v.>>.>......v.>.v>>>>>...vv...v.......v.>v
            .>..>>>.>>>v...vvv.>..>.>v..v.v>..>.>v.>......v>vvv.>v>..>v.vv.v...v.v.vv...vv.>.>....>.vv...vvv>..v>vv>v.>...>..>.vv.....v........>v..v>.v
            .>v>...>v.>..>v.>.>..>.>>.>.v...>.v.vv>....v.v..v...v>v.>vv>>.>>...>>vv>>v>v>...v.>...>>.v>>v>>....>>v.v..v.v..v...>....>..>>.vv..v>.v>v>..
            .v....>v>.....>v.v>v.>...>.vv....v..>....>..>.>v..v.>.>>>.>v>>v...>..>....>>v.vv.v>.v.>.vv>..>...>v.v>.>.>..v.v.v>vv....>...v.v.v.v...>.>..
            v>>..v>>...vvv..vv..>.>>>...>.v.>v>>...v.v>>vvv>>>....v...>v>.>...vv>>v..>.vvv..>.>.v.>v>v....v.v>>.v.>v.v.....>vv>.......v..v.v>.v..>v>.>.
            ....v.>.v..v.>>v.vv.>.v>vv.v.>>v.vv>v...>>>v>.>vvv>..v.>.v..>v..>>vv...vvvv..>>....v.vv>>>vv.>.v..>...>>v...>..>..v..v>vv.vv..v>vvv>v.v...>
            .v>>v..>>v.>.v.>v.vv>...>...v>..v>vvv.vvv...v..>..>v>.>...v.>>.v>>vv.v...v..v.>v.v>.v>v.>.v..vvvv.>.>v>.......>>.>v>>>....>>v.>.v>vv..>>>.v
            .v.>.>>v.>v>vv...>.....v>.vv.>>.v>v.vv...v>.>v..vvvvv......>v.v..>.......>v.>.....>v.v>.>v>.v>..v.>vv.v....>.vvv.>vv..vv.v>v>.......>>..vvv
            vvvv>..>v.v......>vv.vv..>v.>...>.v.v.>.>>>..v>.>.vvv...v..v>.>v.>v>...>..>.>>.v.>v...>v>..>.v.>.>>>>>.v>.v.>v...v.>.vv>..v...vv.......>.>v
            >>.>.>.v.>.vv>v.v>>v>>v.>>.>..v...>.>>..vv>.>>v>.>v..>.......v.....v....v.>>...>.vv.>>...vv>.>>.>v.>>vv>.v>v.>>.vvv>>>v>.>>..>>..v....v>>.>
            v..>>.v...>..>....>v>.>>.......>..>v>..>..>vv.>vv.v......>v.v>v.......vv.>...v..v>>v..>.>>v...v>>.vv.>>..v.>>.......>.v...>....>>>..>v.....
            ...>.v..>>.>>>>>..vvv.v>vv>.>....v>vv>..vv.vv...>v>v...>>v..>...v..>vv.v.vv...v.>.>...>>....>.v...>vvvvv..v>.vv.>..v.>...v.>.v...v.>>.v.v>v
            >>>..>.>v.vv>>...>>..>v>.>v>v.v..>...>>vv>..>v.>vv.>>.>.....v>>vv.>.>.............>>.vv..vv.>.>v>vv>...>...>.v>v.v>.>v.....>.>>>.>v>.>..vv.
            .vv>....v.v.v...>v>.vv>v.....v.v>...>>>>>v>...v..>>v.>>>v.......>vv...v>..v..v.....v...>v....v.v>v>>.....v...v.>.>...>v..>>..>>.>.v...v>>>.
            .v.vv..v>v>v>.v....>..v>>..>.v....v>vv.vv..>...v>..v....>..>>v........>.>...v..>....>vv..>.v..>>.>..v>.vv..v>.>.>.v.v.....v.>..>v..v>>.vv>v
            >>v>.>>....v.v>.>>>.v...>>v.>.>.v.>...vv.>.......>>.v..>.>>>..v.v.v.......v.>.>>..vv.>...>>......v....v..v>...>v...>.v>.v..>.vv.....>>.vv>v
            .vv.>.>>...v.v.vv>..>v>..>vvv>>>.vv...>>.vv.v.v>>.>>v.v.v..>..>v...vv..vv....>v>v..>vvv.....>v>v..>...>>v.>.>>>>..>.>>.v>...>...>..v..>..>.
            .>>.v.v...>..>..>vv.v>v.>v>v.v.v>>..vvvvv...v.vvvvvv>>v........v.v..v>v.>>>.>v...v.>..>>v...v...>>.v....v...>.>....>v.v>>>.....>...v.v.vv..
            >.vvv>v.v>..v>.>vv.........>.......>>.vv>v.>...v>>.v>.v.v.>.>......>........v.v..>.v>>>.v......>>.>..v>v..>.vv.....v>..v>vv>..>..v..>vv>>..
            .v>..v..>.v....v>....>.vvv>.>.>v>vv>v>>..........vvvv>vvvv..v>vv......>>v..>>>v>>.>..>vvv..>..>>v>v.vv>>..>.>v.>>.vv>.>....vv.v...>....>v.v
            >vvvv>>v.v..v.>>..v>...v.v.v>..>>..>..>.>>vv.v.v...vv>...v.v>v...v.>.>vv...v.>.v>..v>..v>>>.v>.vv>..v>>....>....>...v>.v......vv.v.>.>>>>v.
            v..>......v.v>>.>>..v.v>v...>>.v...>....vv>....>.>.>>..v.vvv>>vvv.v>......v>>...vv>...v.>>vv...>v.>>vv.vv......>.v.>.v>>..>v.>>>..>v.v>.vv.
            >..>v..v>vv>.v>>..vv.v>.>>..v.>vv.>v..>v>..>...>...v........v...>vv....>.>...>.>..v....v.v>.v.v....v.v>..v>>.>>.>..v>..>>vvv.>>..v..v.>v...
            >.>.v>>....v>>v>.vv..v>.v>....vv>.......>v>..>v>>v.>vv.>v.v>>v.vv..>.v.>.>..v.>...>.v..>.v..>.>.>v.vv>..>.>>..v...>>...v..v>>>.>>.v>.>.>.v>
            ....v.v.>.>>.>.....v...v>>>.>v..v..v....>>>..vv>.>>>>>.......>...>...>..........>.v>...>...v.v....>.v>>>v.>..vv.....vv>v..>v.>v>>.v......v.
            .>.v>>v>>v>>...>v..v.v>.>>.>v.>v.>.vv.v>>>>vvvv>.>>v..vv>>.vv.>>v..v.>>...>v>>>....v.v>v>v>>>........v.v>v>>>v....>...vv>>>>v>v.>>v>>vv....
            >.>>..v..vv.>....>.v.>.v.v>>.>..vv..>.v...>.>vv...>...>....v.v...v>>.v.v>>..>...v...vv>>.>vvvv....>.....>......>.vv.>..>vv>>v>v....v......v
            v..>v.vv.v.v>>v>..v..v>>...>>.vvv>.v..vv>.v>>.>..>v.v>.>.vv.v.>....v.>>.>>.v>v>.v..vv.v>.v...>...vv>v>v..>>.>.v..>.>v>...>...>vv.>..v..v>vv
            >>.>.....>v..>vvvvv.>>..v..v>..>v...>.v..vv>>>......>...v..>v>..vvvvvv...vv>.>...vv>v..v..>.......>.>v.>...v.>>.v...>...>...>v...v.>vv..v.v
            .>>v>...vv.>.v>.v.>v..>v..>v.>v>v.v.>.........v.>v..v.v.>..v>....v....>v.>>>..>>v>.v...vvv.>.....v.>>>>v>v>..>..v.vv>>..>>.....>v...v>.....
            >.>.>v>>>vv>>...>...>>>vv......v...>.>vv.>>v>.v.vv...v.>.>..v....v.v.>v>.>....>>.v...>>.v..>.v...v.v>vv...v.vv...vv.........>....v.....v...
            ..>>.v...>..vvv.>....v>.>v.>>.>..>>.>.....vvv..>......>>>.>.....>.>>v...v..>.v.v.>.v>>..>>>....>...v>>vv>v..>vv>..vv>.>>>>.vv.v.>>>v...>>vv
            .>vv>.v>.>.>.v>......>.v>v......>......>>v..>v..v.v...vvv>>....v...v>v.v>>v.>v.v.>>>>vv.vv....>.>.v>.vv.v..>.>v>>.vv.v>..>v>.....>..v.>.>v.
            >v.v..>.>.vv>.v>v>....>..v....>.vvv..>>>>..>v..>>..v>...v>....>>.v..>v...>.>..v>..v.v.v>>.vv...>v.>...v.v..>v....v.v..vvv.>.v>v..>vv>......
            ...v.v.v..>..vv>v>v>>v..>>>>v.....v>v.>>...v..v..>vvv>v>v.>vv>..>vv...>.....>..vv..>>.....>.v.....>.v.>>..>..>.v..>v.v>>..>.>v>v>.v>.>>v.>v
            vv>..>v.vv>>>v.....vv>...v>v>.>..>.v..v>v......>.>v.....v>.>.v.v..>>....vv>......>>v.>v.v..v..>v.v.>>.>vv....>.>>>.vv.v.vv>..>..v...>.vvv.v
            vv>>>v..v.v..vv.>>>.>..v>vv..>v>..>vvv.v.v..v.>.>v.v.v.>.>v..v..>.>v..v.v.v>.v...>v.>.>..v..>..v..v.>vvv>>.v..v..>v..>.v...v.v.v.v>.>.v>.>.
            .>>.>.v....>..v.v..>.v>.>>>.>v.>>v...v...>v>v.>..>.......>>..v..v>.>...vv.>...>>.>....>...>>..v....v>..>v.v>vv>.>.v>v.>.>......v..v.v>.vv>.
            ...>v.v>v.vv.>.>...v..v....>v.v>.v.>.>v>v>>.v..vv.>>.vvv.>>.vv>>>..>v.v.v..>.>>.....>>...>v.>vv.>>...>...>.....>.>>.>.....vv>.>v>v..>..>vv.
            .....>..v...v.vv.....vv..>>vvv>.>..vv...>..>>..>..>.>..>......v.>.v.>.>.v>.>>v.....v.v...v..>.......>>v>>>...vv>v.....v..>v..>.>...>v...>>v
            ..v.vv...>.>>..>...>..>>>..v.vv.v>>vv>v.>.v...v....>>.>.>vv.v.vv>v..>..vv.>>>.........>..>.>v..v>.v>.v..>>v..vvv.vv...v>>vv..v.>..>v..v.v..
            >.v>.>.>v.v..v>>.v.v..v>v>>v.v.>v>..>..>vv.vvv..v>>....v..v>>vv>......>...>>.v..v..>..v...>..>v..>v...v.v.v.>vv.vv.>>...>>..>....v>v>>>v..v
            .>.>..v.>v.>....>....>>v...v>..>.>v.v>>>.>.>........>v.>v.>..>>...>.>..>..v>.>..v>..v>.vv.v...v.>v..>v.vv>..v>>v.v.>>v...v>v...>.v...vvv>..
            ..>>>.vvv.vv..vvvvvv.v.>v.v.>...vv....>v.v>>..v.>>.......>.v.>vvv..>v..>.v....>vv.>...>>...v....>.....>.v.>>>>>...>..>..>>v.vv.>vvv>vvv....
            .v>v>>v.v.....>..>>..>>>>..v>...v..v>..>v.vv...v>...>...v>..v..>..v>.>v>....>>vv>vv.v..v>v...vv>v>v>>.v..>v.>>..>.v>>>v.v>v>..v....v...>>..
            v>......v..v.>vv.vv>..vv...v...>v..v.>>vvv.v>...>.>...>>..v....v..v.>.>>v......v.v.vv.>...v.>>.>>......v..>v>>v>>...v>>......>..>..v..>...>
            vv.>..>.v.>...>>>..>.v..vv>......>>..vvv..v.>.>.>.........>>....v....>v>>.....v.v.v.v..>v.....>......vv.v..>>>>>>..>..v..v>v>...>v>>.>....v
            .>v.v>v>>v..v..v.v...v.v....v..vv>.v>.>.v.>>>>.v.>.vvvvvv>v>>......>vv.>>.........>.v.>.....>>..>.>.vv.v.>.>.....v.>>v.....v.v..>v>..v.vv..
            >....>>>>v.v>.>..v>..v>vv.>>..>v>.>>..v>v.>..vvvvv....v>>..>.v>>.>.v.>v>...>.>.v>...v.....v...v.vv>v>..v.......>.>.v>>>...>........vv...>vv
            v>v.vv.>>>v>.....v....>....>.......>..>...v.>v.v.v.....>v>>>...v.......>v...>>v.>v.v.v..v.>..>.>v..vv.v.v.>v..v...v..v>.vv>>..v...v.>.v..v.
            v..v....>v.>.>...>..v.>v.vv.....>.v>....>..>>vv..v...>>..>.vv>v>.>v..>vv...v>vvv>v>.>v>v>>>.vv.v>>v.vv.>.v.>........>v......>.>.v..v>vv....
            >vvv>..>..>.v>>v..........v>.>.>>.>.v>.....vv>...>...v..>v>.>v>>.vvvv.>>.v......v....v....vv..v..vvv.>...>...v>vv....>>>v>vv.v>>>.>.v.>>v.v
            v..>vv>>vv.v.v..v.>>..vv.>>v.>v>v...v.>..>.>v......v....vvv.>..>....v..>..v>.>v..>.>v.>.......>.>v...vv>>.v....>.>v.>>>v.>v...>..v>v>..>>>v
            vv.vv.v.vvvvv>...vv..........v>vv.v.v...>v.>>..>>vv>..vv>v.v.>.v..vv>>...vv.v.v.>.vv.>vv>.v>>.....v...>>.>v.....>..>>..>>..v...>vv>.v...v>>
            .v.v..>v..>...v.>.v.....>>..>.>>vv>>>v>.......>.>>...>..>.>>..v...vvv.>..vv..>v>v..>>..>.....>..v..v....v>>v.v.>>>.v>.vv.v..v..>v.>.>>...>>
            .>..v>>v....v.>v..>vv.v.>..>..>>v.v>>.....v.>>..>>.>..>>>>.v>vv..>.v.>.>...>>>.>......vv...v.v.v...v>.>.>.v..vv..v...>v.....>.v>...>..>..v.
            .....vv>..v.vv>.>>>.....>.>v.......v>vvv..v.>>.v....v..v.>v.>v>.v>vvv...>>>>>>.vv.>.v.>...>v..v....>..>v.>>>vv.v>.>.>.vv>...>>v.>>.vv.>.>v.
            ..>>v...>..vvv>>.>v>vv....v..>v..v..>v>...>.v...>>.>>.vv...v>v.v..>.>>.v...>v....>>>>.v.v.vv.v.>>.vv...vv>.>.vv..>>.>.>vv.>..v>..>.>.v...v>
            vv>>v>v.v>v>>v>v>>v>v..v....>..>.>.....v>>.>>v.v.>>>v>.vv.>vvvv>..>>>...>....v>..>vvv.>.vvv>>v.v>..>.v.v.>.v.v...vvvv.>>......>..>v.....>>v
            >.v>.v>v..>.>..>.....>.>>.>.>..v.v..v.vvv>.>>.v..>.v.>.>v>v>.v>>>v.v...v>v..>..>>.v.v>.>.>..>.>v...>.v..v>v>v...v..>>...v.>>....v.>v.vvvv>.
            ..v..v>.v.>v..>..>.vv.v....v.v..v..>>.>>.v..v.vv>v.>.vv..v.>.v....v......vv....>>>v..v...v..v>>>.>...>>v.v>vv>vvvv>.vvvv.>v>..v.>>....>.vv>
            v..vv.vv.v.>...>.v..>v.v.......>...>>.>.>..>>.>.>>.....v..vv>.v.>v..>...v>.v>.v>>v...vv>v..v...v.>.>...v...vv..v>v....>.>v>>>v..v>.>v>.>...
            ..>..vv..v..vvv>v>v..>>.>....vv>...v...v..>.v.v>......>>..v...vv>>...v>v.v...v....v>v>..>v>.......>>.>v..v.....vv.v..>.>..>v>.>.>.v>..>vv>.
            v>>v.......>.vv....>>.....v>>v.....vv...>vv>vv>...v...v>>.>.v...v.v.....v>....v>.>.vv.vv...vv>>v..>v...>.v....v>v>..vv>..>....v>v>.v.v.>...
            v.v.v>.>>.v>>vvv..v>>.>...>.....v.>.vv>v.vvv.>>>v.v...>..vv..>..>.>v.....>...>..v.....>....>.>>.>>v.v>...vv.....>.>.>v..v.>vv...v>>>>.>.v..
            .vvv>>>>.v.v.vv.v.v.v.>....>v>....>.v>.v>...v.>.v.>..>.v..>>..v>.vv.v......v...v>>..vv>>.>.vvv>.>>..v.>>>..>.>>>.>>v...v.>.>..>>v>>>v>>.vv>
            >.>v...v.>>v.>v..vv.>.>.vvv....>.v>v..>v.>..vv>.>v....>>.>>....v.v>>>.>vv>>.vv......>v...v.>.....>..>..>.>.v...>v...v...v...>v.v.vv.....>v.
            ...>.vvv>.v.v.v.>..>...>..>>>.>..>.>..>..v..>vv.v.v.>.....>.v>....>.>.>....>v.v>.>.>.v..>...>..>>..>>...>.v.v.>..>.>vv....>>>..>>.>.>..>...
            >>......>vv....v.....>..>>.>...vvvvv>......vvv.v>.v>.>....>>v.>>vvv...vv.>...>>.v>..>........>>vv>v....>.>..v.>v.>..>......vvv>>......>>.v>
            v.>....>.v.v>>..>.v.>>v>vv>>>>.v..>v>v>.>..>>.v>>.v.v..v>v.>v.v>vvvvv...>.v..v.v.....>.......v..vv...vv.........>..v....vvv...>..vv>.v.>>.v
            ....>v.>.....>....>v.>...v.>v.v>.v>.v.>.>v>>v>>>v..>>v..>v.>....v.>>>...vvv.>....v..>.>...>.v>...v>v.vvv.>v.v.v>>>>..>..vv.>..v.vv.v..v.v.>
            v...v...vvv.>>>v.>....vv>..v..v.>v.>v..>.>v.v.....v>...>...vv>..>.v.v>>vvvv>.v>>>...v>.v>>...v>vv..vvv>.v........>v>.vvv.vvv...v>.v.....v.>
            >....>v>>..v.v..vv>.v>.v...vvvvvv..v.>.>...vv..>>.vv.>..>v>v..>>...>....v>v.>.>>vv.vvv>v.v>>..vv.>..>...vvv....>..vvv..>v>v..>.v.>>vv.>vv>v
            vvv>...vvvvv>>v....>..>.v>v.>.>..v.>v.v>...>>..>v>.>v>..vvv.....v>..>.>>vv.>>>>>....vv.>>v.v.v...v>>.v....v.>v...>..>..>.>.v.v>.>.>.>v..vvv
            ..>>>>>.v>v..>v.v>v>>>v..v>>.>vv...>.....v>>v....vvv..>...>.>.>>..>.v....v..v>v....>>vv..>v>>..>...>>..>.v.v.v>.v.>.vv>v.v.>......>>.v....v
            .>v..>..v.v.>v.>.....>vv>..v>v.>.........v>.>v....>..>>..>>..>>.....>v>vv..>.....v.>...>.>>.>v....>>>.>....vv>.>>>>.>..>>.>v>>vv.vvvv>v.v.>
            .v.>.>>.>.>v>v>v>vv>.vv>.>>v.vvv>v..>.>v>v.v..>..>.>>>>>..v..v.>.vv...>.vv..>>v>>v..>v>....>>....v>v.vv>>v.v.v..>..>v..vv.v.v>v>.>...>..>..
            vv>...v>>.....>>>v..>..v.>v.>v.v>vv...>........v..vv.>..>>>>..>>v..>...>v.>>>>vv.>vv>....>.vv.>>.v....v.vv.v>.v>>.v...v.v>.>.....v>....v.>.
            v..>>.v....v..>.v.v..vv..vv>>vvv.v..>>.>.v>.>v>...>.>>>>>vv>>...>v>.>>>v..vv>>vv.>v.v>.v...v.....v>>v..v..v.v>v>>....>.vvvv.>vv>>v>>>>>v...
            v.>v.v..>v>..vv>....v.vvv.vv.v>.vvv.vv.v>..v.v.>>>>..>.>v...v.....>>..v..>..>vv.>..>v>.v>......>...v.vvv.....v..>.>v>.....>.>>..>>..>>.>vv.
            .vv.>v....v>>v.>...>v..v>vv>.>.....>v>......v>..v.v>.vv>.v>.v.>.v..v.>...vv..v.v.>>v>vv>v..v.>.v.>>>>..>.>>..>......v.>...>v>.vv.>>.>..v>v>
            vv>>>v..v..v..>.v.v>.>vv>v..v>>>>.>.v..>vv.>.....>v>vv.>vv.....vv.>.v...v.>>...>.v>v>..v...>v.v>>.>>.>v.v>>v..>.>>.>v.v>.>.>vv.>..v>>v>..>.
            v.vvv>......v...>..>vv...>.>.>..>>....v>>..>.vv..>..v.v.v.>>.vv...>..v>.v....>v.v>.vv>v.>.>.v.>.>v.v.....v.v.v>.>..vvvv..>v.>v>.>...v>>>...
            ........>>v..v.v..>.>>.vv.>...>.v.>v...v....v.vv.>v>>.>.v...>>>>.>...v.>>...>>v.v.v>.v..>>vv...v.....>..v....>vv>.v>....v.>..v>...>..vvv>.v
            vv.v...>......>.....vv>..vv...>.v>>>>.>v.v>..v.v..v>.>vv.>>.v.>..>>.......v..>>...v>>.>.>...v>>>.vv>..>.>.>v>..v>...v.v..v>.>......v>v..>vv
            ..v.>..>vvv........v..v.....v...>.v..>.v>>>.v...v..>v...>>>>...>....>v..>.>..v.v..>.v..>..>>.>>..v..>>v.>v..v.....vv.>>>.>....vv>.v.>v.....
            v..v..v.>.>..>..vv>.>>.>>.v>...v...v>vv>>.vv.>....>.v.....v..>.vv.v..vvv.v>>v..v.vv..v....v.v..v>..vvvvv.v..>v>.v>v.>>v>..>v.vv.>>..>>.....
            .>....>..v..v.v.>.>..v>.>>vv>vv...v>>...>v..v..vv.v>v>.>>>.v.>.>v>.vv.v...>>.vv.>..>.....v.>v>v...vv.....vvv>vvv>vvv..vv...v...>v.v.vvv..>v
            >.vvv..>.>.>..v>v.>....>v.>>.>....>v>...v.>..>...>.v...>v..>....vv....vv..v.>..>.v.>..>v>...>>..v.>..>>..>v..vv>>>..v..v>......>>>v..v...>.
            v>>..>>v..>....>vv.....v>.v>..>v>..>v..>...>..>v..v>.v>...>v.>.v.>.>..>v...v>vv>v..>>.>v...v>>v>v.v.>vv...>>v..v>.vv...v..v>.vvv>.vvv..v.v>
            ..>.....v>.v........v>....v.>>...>>.v>>>>>vvv......>>..v.>v>v.vv..>..>>.>.v>.vv.>...>v....v.....>>..v..v>.>v..>>......v.....>..v.v......>v.
            >.>.>vv....v>....>....>v.v.>..>>........v.v...vv..v.>..vv.>......>.v.v.vv...>>>..v>v..v.v>.vv>>...>....v..v.>v.v>v..>>..vvv.vv...>.>.v..v.>
            ..>.>.>v.v.>vv.v>.v.>v.>>..>..>v>vv.v.vv>.>>>...>v......vvv.vv..v.v.v.v...>.>>v..v.v.v>.v.v....>>.v.v.>>v.v.>..>..>..v.>....>>v>..v.v.vv..v
            ..vvv..v>..vv>..>vv..>.>...v>.......v.>>..v.>>.>..v.>>>..>v..>.vv.>vv.v>v......v.v.....>..>.v....>.v....>v.v>..>>.>>>vv.>v.vv.>vv.v.>..>...
            .>>vv>.........>.v>..>.>....vvvvv.v....v...v....>..>.v.v...vvv...v>v>.v.>v..>v>v..>.v..vv>...>vvv...v>..v....>vv.>.v.>.>v..>..vvv..vv...>.>
            >.v>.v..vv>>.>...v>.>...vv.>.v.vvv>..>...>v..>.>>v.vv..v.v...>>...>.>v..v.>v.>.vv.>>v.v.vv.>v>.>>.....>.....>>>.>..>.>..>..>.>.>..v...v...>
            vv..v.>>>..>>...>vv>.>>.>v>v...>.v>..>..>v.>.>.v>>..v>...v>..v>v....vv>....v>v.>.v.>..v....>v.>>v.......v.>>>..>..v.vv>>.>>>..>v>>v.v..v.>v
            >.>..>...v.v>v.v..>.......>..>.vv>...>>vv..vv....>.....>....v.vv.>>>>v>>>.>vv...>>....>v...vv.v>.>.....vv...>>v.>v>>..v.vvv.vv.v...>.>>..v.
            >>....v.v.v...v.v>.>v>...>.v>v.>..>v>>v.vv...>....>......>..>vv....v.v.>....v>>...v.v.v.>>..v...>....v>..>.v>v..vv.v.>..>>vvv....>>..>.>>>.
            ......v..>>>>>.>..v..>>>.....v.v..>..>v>...v.>..vv>>>>...v..v>...>.v>..>.vv....>>.>v....>...>.....v....vv...v..>.>v>.>>.>>.>>...v.>.>.v..>.
            v>vv.v.v.v>.>v>v.>...v.>>..v.v>.>.>vv>>.v>.vv.v..vv..v.v.v>vvvv.>v>v..>v>vv>.>.v.>.>>.>v.>.v.>>>.>.v.......v>>v...>.v..vvvv.vvv>.v.v>>>>.v.
            >v>....>>>.>v.>..>.v.>>..v....>....>...>..>>vv....vvv>v...vv>>.....>..vvv>.vv.....vv.v>>.v...>v.>v>.>..v.v.v>v>>.v>....>>v..v..vvvv..>>v..v
            >v....vv.v.>.>..>v.vv....v>v...>v...>.v.>>....>.v>.>.v.>.v...>.>..vv.vv>...v.v>.....>...>>..>vvv>.v..>>vv>.>.>v.v>>vvv.>v.>.>>>>vv....vv>.>
            .v>vv..>vv>vv.>.>..v..>...>.v>>v..v>>v..>......>..>..>>v>>.>.....v..vvv.....v...>>.....>>>>.>>...>>>..v.v....v.vv>>...>.>.>vv.>...>.>.>>v.>
            ..v.v>v..v>..>..v...v..v......>.>.>...>>.>v..v>..>v...v...>>v........>.v>..v.v.....>v....vv>>....vv..v>>.>.>.>>vv...>.v>.v....v..vv........
            .v>>...>v..>v...>>.>....>>v>vv>v..v..v..>...>>vv...>..v>v..v>v.>v..>....>.v.>v..v>>>v.v.>>>v.v>v.v>..>>v>v....>v..>>.....v.v....v>v..>...>.
            v.>.>.....v.v.>>v>>...vv.v.vvvv.>>....v..v.v>.>.v>.vv.>>v..>..>...vv>.>v>..v>.v.>v>v..v.v>v>vvv.>>.>.vv.vvv.v...v....v..v..>>....>vv...v.v.
            .>..>>>..>..>>..v..vv>.>.v>.>v..>>>..v...>..v.v..>...v...v....>>.v......v..v..>>v.>vvv>..v.>..v...v..v..v..>>>.....>...v.v.>>....v.>v.>.>>v
            v..v.>..vv....>v...vv..>..>>..vv>>v.v.vv>.>.v.v.v>.v.v>>v.v>..vv.v..v>>>>v.v>..vv....>>v....>.v..v.>>.>vv>.>v>...>>>vv.v..>v.v>.>........>.
            v.>>>....v...v>..v.v.>.v...>.>.v>v.v.vvv.>v.>>.v>vv....v.v.v.>..vv>...>>..v...>.v>.>.>v.>>>>..>>>>>>v.v.v..>v.>>.v>.....>..v...v..>>...v>>.
            .vvvv..v.>.>.>v>v.v>.>.v.vv>.>v.v.....>...>>vv.v..vv..>...>v...>vv.vv.v...v..vv>>..v>.>.>.v.>..>..>.>.>.....v..vv..>.....vvv>>....>v.....v.
            v.>>.>..>.>v>>>vvv>.>.vvv>...v........>...vv..v..>>.v>.>.vv..>>vv>....>>vvvv..v.....>vv.v.>>v>>.>>v..>.>...v>...>.>v.v..>.v....>>....>>v..v
            ..vv.v.>v>v...>.vv.vvvv>....vv....>.>.vv>...>..>..>.>.>.....>v>.....>...>v..>v>>..>>>.....>......>.>v>>..v..v.vv.>>..>..>>vvv>>vvv>...>...v
            >..v..>>>.>>v.>.v>>>>..>....vv>>...v>....>.v>v..>>.>..>v>.>>.v..vvv.>v...vvv>..>>v.v>>v.>v.>...>vv>..v.v>..>.>......>......>>..>>..>>...>v>
            ..>>....v.>>....v...>.v.v.>v..v....>.>.>.>>...v>..>.v.>.v>.vv>>>v.>.>>>vv..>>v>.vv.v>......vvv.....vv>.vv...>..v...>>.>>..v>.>>v>.v>>.vv>..
            .v......vv.>.v..v..>........v>.>.v...v>vvv>.vv...>..>....v>.v..>v>.>>.>v...vv.>>......>vv..vv>.vvv>>>..>..>v.v..v.....>.....vv>.>vv....>>.v
            ..>>v>.vv>v.>....v>>>vvv>>vv.v.>..vv.>.v....v>>...v....>.>vv...>...v.v>..>.vv.>.v...>....v.v>>......vv.vv..>>vv>.....>v...>>...>..v.v.v.vv.
            v..v.>.v.vv.>v.>...v>.........>>v.v.>>..........>vv.>>......>v.vv..>..v.v>v.>.v...>v.v...>.>...>>vv>.v..>vv.v>>..v.v...v...v.>.v.vvv>>.....
            ....>....v>.>.>v.>v..v.v>>v>>v..vvv...>.>..>vv>>>..v.v..v..v....>>.>........>.>>vvv..v>>..>.v>>v.>.v>>v.vv...>.>v....>v>..v.>vvv..v..>vv>.v
            ..>v.>..........v.>.v.>.>.>..v..v.>...>.v........vv.>vv..v>.>..>..>v...vv..>v>>...v>..v..v..>vvvv.>v....vv...>.>....v.>.>.>...>.v.>>.v.vv..
            ..v>vv..>.v.>.>vv>v..vv.>.vvvv..v>v..v>.v>v.....vvvv.v>.>.>v.>.>....>.>.v.>.v.v>>..v>v.>vvv..>>..>..>>..vv.v...>.v...>v..>.>>.v..v>...v>..>
            >v.v.......v..>>v>v.>v.....>v.>.vv....>.v>>v...>v.v>>>.>v>>...>v.vv.vv.v>.vv>..v.vv>v.>..>.v.>........>.>....>.>.v...>...v>....v.v>>v>..>v.
            v>vv.v>.v...>..>..>..v.>v>..>v.>..v>>v.>>.v.vvv...>.v>.....>.>>..v>v..>>v>.>..>..>...>vvv....>.>.vv>>>.v...v.v>.>>v>...>...>.>vv.vv>.v.>v.v
            ..>v..v>v.>>.vvv..v>>v..vv..v>vvv.>..>>>.v>.......>..vvv.>v...vvvv.v...>v>>>..>.v...>.>>v..v..>v.>......v....v>v>>>..v.v.......>.vv.v.v..>.
            v...>>......v>>......>>v.....>....v.>v.>>v>>>>v>v..v>.v....>...vv..>>.v>v>..vv>.vvvv.>>.>>>v>.vv.>>.v.v......v>>v.v>.>...>.>..>.>>.vv......
            >..v..>>>v>>.v.vv.....>>>..vv..>vv..v.v>..>v.>v..>v..v....>..>>>vv>>.v>>..>v...v....>>>vv.v.vvv.vv..>vv.>.vvv..>>>>.>>.>v.v>>>..>v..vv....v
            .v..>v.>v..vvv.>.>v..>..>vv...v..>vvv...>v.v...>.v....>vv.v.v>v...v>>v.v.vvv..>.v>v>>.>..>>....>>.>..vvv.vv...v...v.v..v....v...v.vv>>vvv>>
            ..>.>.v.v.>v>.vv..v.v.>.vv..vv.v...>..>.....v.>.......>vv>>>....v...>.....>.v..vvv>.>>v..>.>.......>.>v>.v....>v>>.v>>.v...>.v>.v>..v>>.v>.
            ..>.v.>.>>.>v>.v..v>...v>.v.>>.v>.>.>>..v....vvv>>...v>v.v>...v....>..>v.....>>.>vv.>>>..>..>.v.>>..>v>>>.vv>..vv.v..>.>...........v>.v....
            ..v>v..>......v>v..>.vv.vv>....>...vv.v>>.>.....>>..>>>v.vv.v....vvv>v..v..v>vv.>....>v.v...>v.v>v.>..>>..>>....>...v..>.v>.vvv>.>>.vv.v>v.
            v.v>..>.vv.>>>..vv.>.>>>v...>v>v.>.>>..>>...v.v>v>>>vv.>>.>v.v.>.>vv>..v.v..>.v..v......>v>v.v..>...>.......>v>.>.>.>..v.v..v>.>>....>.>>>.
            .....>....>v...v....>...>..>v..v.vv>v>....>...v>v.>.v>>..v>>v>vv.....v.>..>>v>>....v.>.>..>.v...>.>vv>...vv>>.vv>v>.v.>v..>>vv>v..>...>..v.""";
}
